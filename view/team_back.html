<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .mypostingbox {
            width: 500px;
            margin: 30px auto 0px auto;
            padding: 20px;
            box-shadow: 0px 0px 3px 0px blue;
            border-radius: 5px;
        }

        .mycards {
            width: 1200px;
            margin: 30px auto 0px auto;
        }
    </style>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            apiKey: "AIzaSyAqawipQY7PqRA7NMRL76E7pOi5dtIRk5Q",
            authDomain: "iam-dev-623b3.firebaseapp.com",
            projectId: "iam-dev-623b3",
            storageBucket: "iam-dev-623b3.appspot.com",
            messagingSenderId: "145871608299",
            appId: "1:145871608299:web:9925c338c21f80c66261ae",
            measurementId: "G-W79BXK25S1"
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        $("#AddTeam").click(async function () {
            let teamName = $('#teamName').val();
            let teamGoal = $('#teamGoal').val();
            let teamCharacter = $('#teamCharacter').val();
            let teamMember = $('#teamMember').val();
            //{member1,member2,member3,member4,member5}
            let doc = {
                'teamName': teamName,
                'teamGoal': teamGoal,
                'teamCharacter': teamCharacter,
                'teamMember': teamMember
            };
            await addDoc(collection(db, "team"), doc);
            alert('저장 완료');
            window.location.reload();
        })

        let docs = await getDocs(collection(db, "team"));
        docs.forEach((doc) => {
            let row = doc.data();

            let teamName = row['teamName'];
            let teamGoal = row['teamGoal'];
            let teamCharacter = row['teamCharacter'];
            let teamMember = row['teamMember'];

            let temp_html = `
            <div class="col">
                <div class="card h-100">
                    <p> 팀 이름 : ${teamName} </p>
                    <div class="card-body">
                        <h5 class="card-title"> 팀 목표 : ${teamGoal}</h5>
                        <p class="card-text">팀 성격 : ${teamCharacter}</p>
                    </div>
                    <div class="card-footer">
                        <small class="text-body-secondary">팀 멤버 : ${teamMember}</small>
                    </div>
                </div>
            </div>`;
            $('#card').append(temp_html);
        });

    </script>

</head>

<body>
    <h1>팀 추가 테스트</h1>
    <div class="mypostingbox" id="postingbox">
        <div class="form-floating mb-3">
            <input class="form-control" id="teamName" placeholder="팀이름">
        </div>
        <div class="form-floating mb-3">
            <input class="form-control" id="teamGoal" placeholder="팀목표">
        </div>
        <div class="form-floating mb-3">
            <input class="form-control" id="teamCharacter" placeholder="팀성격">
        </div>
        <div class="form-floating mb-3">
            <input class="form-control" id="teamMember" placeholder="팀원">
        </div>
    </div>

    <div class="mycards">
        <div id="card" class="row row-cols-1 row-cols-md-4 g-4">
        </div>
    </div>
    <button id="AddTeam" type="button" class="btn-outline-primary">ADD</button>
</body>

</html>